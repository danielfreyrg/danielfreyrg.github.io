<!DOCTYPE html>
<html>

<head>
    <title>kirkjuleikur</title>
    <link rel='stylesheet' type='text/css' href='style.css'>
    <script type="module">
import Sortable, { Swap } from "https://cdn.jsdelivr.net/npm/sortablejs@1.15.2/modular/sortable.esm.js";

// Register the Swap Plugin
Sortable.mount(new Swap());
function isDropAllowed(evt) {
    const targetContainer = evt.to;

    // Ensure targetContainer is valid before checking classList
    if (!targetContainer) return false;

    // Limit for the middle vertical part (max 4 items)
    if (targetContainer.classList.contains("middle") && targetContainer.children.length >= 4) {
        return false;
    }

    // Limit for the left/right parts of the cross (max 1 item each)
    if (targetContainer.classList.contains("droppable") && !targetContainer.classList.contains("middle") && targetContainer.children.length >= 1) {
        return false;
    }
    if ((targetContainer.classList.contains('right') && targetContainer.children.length >= 1) || (targetContainer.classList.contains('left') && targetContainer.children.length >= 1)) {
        return false;
    }
    if (!targetContainer.classList.contains('droppable')) {
        return false;
    }
    return true; // Allow drop if within limits
}
// Initialize Sortable for the options container (letters)
document.addEventListener("DOMContentLoaded", function () {
    new Sortable(document.querySelector('.cross-options'), {
        group: {
            name: 'shared',
            put: true, // Allow items to be moved out
        },
        animation: 150,
        sort: false // Prevent sorting in the initial letter box
    });

    // Initialize Sortable for the cross (droppable slots)
    document.querySelectorAll('.droppable').forEach(item => {
        new Sortable(item, {
            group: {
                name: 'shared',
                put: true, // Allow items to be dropped here
                pull: true, // Allow items to be dragged out
            },
            animation: 150,
            swap: true, // Enable swapping
            swapClass: "highlight", // Add a visual indicator when swapping
        });
    });

    document.querySelectorAll('.droppable').forEach(item => {
        new Sortable(item, {
            group: {
                name: 'shared',
                pull: true, // Allow dragging out
                put: function(evt) {
                    return isDropAllowed(evt); // Enforce placement limits
                }
            },
            animation: 150,
            swap: true, // Enable swapping
            swapClass: "highlight",
        });
    });
});

    </script>
    
    <meta charset=utf-8>
    <meta name=viewport content=width=device-width, initial-scale=1>
</head>

<body>
    <h1>Kirkjuleikur</h1>
    <div class="cross-container">
        <div class="cross-item hide"></div>
        <div class="cross-item hide"></div>
        <div class="cross-item droppable left"></div>
        <div class="cross-item droppable right"></div>
        <div class="cross-item hide"></div>
        <div class="cross-item hide"></div>
        <div class="cross-item hide"></div>
        <div class="cross-item hide"></div>
        <div class="cross-item middle droppable"></div>
    </div>
    <div class="cross-options" id="sortable">
            <div class="cross-option">A</div>
            <div class="cross-option">B</div>
            <div class="cross-option">C</div>
            <div class="cross-option">D</div>    
            <div class="cross-option">E</div>
            <div class="cross-option">F</div>
            
    </div>
    <div class="colors">
        <button class="white" onclick="changeColor('white')"></button><button class="red" onclick="changeColor('red')"></button><button class="blue" onclick="changeColor('blue')"></button><button class="green" onclick="changeColor('green')"></button>
    </div>
</body>

</html>